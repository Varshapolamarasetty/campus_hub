<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Student Dashboard - Campus Hub</title>
  <style>
    body { font-family: 'Segoe UI', sans-serif; background: #f5f7fb; margin: 0; }
    header {
      background: #2196F3; color: white;
      padding: 15px; text-align: center;
      font-size: 22px; font-weight: bold;
    }
    .container {
      max-width: 900px; margin: 30px auto;
      background: #fff; padding: 25px;
      border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    h2 { color: #333; margin-top: 20px; }
    #welcomeMsg { font-size: 18px; color: #444; margin-bottom: 20px; }
    ul { list-style: none; padding: 0; }
    ul li {
      background: #eef5ff; margin: 8px 0; padding: 10px;
      border-radius: 6px; font-weight: 500;
    }
    ul li a { text-decoration: none; color: #2c3e50; }
    .logout {
      display: inline-block; margin-top: 20px; background: #e74c3c;
      padding: 10px 15px; color: white; border-radius: 6px;
      text-decoration: none; font-weight: bold;
    }
    .logout:hover { background: #c0392b; }
  </style>
</head>
<body>
  <header>ðŸ“š Campus Hub - Student Dashboard</header>

  <div class="container">
    <p id="welcomeMsg">Loading profile...</p>

    <h2>ðŸ“‚ Available Notes</h2>
    <ul id="fileList"></ul>

    <a href="logout" class="logout">ðŸšª Logout</a>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function () {
      // Load student profile
      fetch('profile')
        .then(res => {
          if (!res.ok) throw new Error('Network response was not ok');
          return res.json();
        })
        .then(data => {
          document.getElementById('welcomeMsg').textContent =
            'Welcome, ' + (data.name || 'Student') + ' (Student)';
        })
        .catch(err => {
          console.error('Profile fetch error:', err);
          document.getElementById('welcomeMsg').textContent = 'Welcome, Student';
        });

      // Load notes list
      function loadFiles() {
        fetch('files')
          .then(res => {
            if (!res.ok) throw new Error('Network response was not ok');
            return res.json();
          })
          .then(data => {
            const list = document.getElementById('fileList');
            list.innerHTML = '';
            if (!Array.isArray(data) || data.length === 0) {
              list.innerHTML = '<li>No notes available.</li>';
              return;
            }
            data.forEach(file => {
              const li = document.createElement('li');
              const href = 'uploads/' + encodeURIComponent(file);
              li.innerHTML = `<a href="${href}" target="_blank" rel="noopener noreferrer">${file}</a>`;
              list.appendChild(li);
            });
          })
          .catch(err => {
            console.error('Files fetch error:', err);
            document.getElementById('fileList').innerHTML = '<li>Could not load notes.</li>';
          });
      }

      loadFiles();
    });
  </script>
</body>
</html>
